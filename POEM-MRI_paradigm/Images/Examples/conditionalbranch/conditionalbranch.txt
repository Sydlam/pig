// Must initialize the StateSpace before using (re-using) it.
stateSpaceInit
// setup list of stimulus images
stimulus_LoadImageFile gray.bmp
// make sure that you have set up the ROI and saved the image ROI
pictureList_Init
pictureList_AddName Examples\conditionalbranch\pref1.bmp
pictureList_AddName Examples\conditionalbranch\pref2.bmp
pictureList_AddName Examples\conditionalbranch\pref3.bmp
pictureList_AddName Examples\conditionalbranch\end.bmp
pictureList_EndAction {stateJump 5} // when end of picture list comes, goto state#5
//
// **** setFKey action
fkey_cmd 9 { stateJump 5 } // when the user presses FKEY 9 then jump to state 6 and close datafile
fkey_cmd 10 { stateEngine toggle } // when the user presses FKEY 10 toggle state engine on / off
//
// **** open datafile
dataFile_NewUniqueExtension "_experiment1.txt"
dataFile_NewUnique
//
// *** STATE 0 idle ****
stateMode 0
stateLabel "idle"
//
//
//
// *** STATE 1 presents next preference picture ***
stateMode 1
stateLabel "present next prefence picture"
stateCommand { pictureList_ShowNext }
stateTimeout 5 2 // after 5 seconds, goto state#2
//
// *** STATE 2 determines which ROI the subject looked at the longest ***
stateMode 2
stateLabel "compares durations in each ROI"
stateCommand { if {MaxDurationROI_EQ_ 1} {stateJump 3}; if {MaxDurationROI_EQ_ 2} {stateJump 4} }
//
// *** STATE 3 present "good image"***
stateMode 3
stateLabel "presents good image"
stateCommand { stimulus_LoadImageFile Examples\conditionalbranch\blue.bmp ; midiNote 5 6 4 ; clearRoiData }
stateTimeout 5 1 // after 5 seconds goto state#1 to start over
//

// *** STATE 4 present bad image"***
stateMode 4
stateLabel "presents bad image"
stateCommand { stimulus_LoadImageFile Examples\conditionalbranch\red.bmp ; midiNote 5 6 4 ; clearRoiData }
stateTimeout 5 1 // after 5 seconds goto state#1 to start over
//
// *** STATE 5 close data file***
stateMode 5
stateLabel "closes datafile"
stateCommand {dataFile_Close }
stateTimeout 0.1 0 // immediately, goto state#0
//
//
stateJump 1
// finally, we must start the StateEngine running!
stateDump
stateEngine On
//
end





